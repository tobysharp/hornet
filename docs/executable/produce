#!/usr/bin/env bash
set -euo pipefail

if [ $# -ne 1 ]; then
  echo "Usage: $0 <file.md>"
  exit 1
fi

INPUT="$1"
BASENAME=$(basename "$INPUT" .md)

# Build HTML
cat header_html.md "$INPUT" > "${BASENAME}_html.md"
npx md-to-pdf "${BASENAME}_html.md" --as-html --config-file .mdpdf.json
mv "${BASENAME}_html.html" "${BASENAME}.html"

# Build PDF
cat header_pdf.md "$INPUT" > "${BASENAME}_pdf.md"
npx md-to-pdf "${BASENAME}_pdf.md"
mv "${BASENAME}_pdf.pdf" "${BASENAME}.pdf"

# Clean up
rm "${BASENAME}_html.md" "${BASENAME}_pdf.md"
